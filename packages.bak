#!/bin/bash

#Colors for when I eventually add them to the verbose
NC='\033[0m' # No Color
ACCENT='\033[1;31m'

while getopts h flag
do
    case "${flag}" in
		h) help="True";;
    esac
done

if [[ "$help" == "True" ]]; then
	echo -e "Usage: ./packages [-b]

[I] Install all necessary packages and remove unnecessary ones on the system

Optional arguments:
  -h,         Displays this message. \n"
else

	#Removes bloat
	echo "\n[.] Removing bloat"
	sudo pacman -Rd --nodeps pcmanfm nitrogen palemoon-bin picom vlc clipit

	#Updates system
	echo "[.] Updating existing packages"
 	sudo pacman -Syuu

 	#Software from the official Arch repo
 	echo "[.] Installing packages"
 	sudo pacman -S --needed gufw xfce4-clipman-plugin xfce4-screenshooter youtube-dl timeshift pavucontrol thunar libratbag curl unclutter gnome-disk-utility baobab python cmatrix xcb-util-xrm tumbler python-pywal imagemagick fehop neofetch firefox pulseaudio rofi playerctl wmctrl xfce4-power-manager polybar redshift trash-cli dunst meson i3-scripts i3exit
	
	#Copies st to ~/ and installs it
	cp -r $HOME/dotfiles/st $HOME/
	cd $HOME/st && sudo rm config.h && sudo make clean install	

 	#Picom Fork with kawase blur and rounder corners
	cd $HOME/Downloads && git clone https://github.com/ibhagwan/picom-ibhagwan-git && cd picom-ibhagwan-git && makepkg -si
	
	#Python Stuff
	sudo pip install i3-py pywalfox

	#Sublime Text
	sudo curl -O https://download.sublimetext.com/sublimehq-pub.gpg && sudo pacman-key --add sublimehq-pub.gpg && sudo pacman-key --lsign-key 8A8F901A && rm sublimehq-pub.gpg
	sudo echo -e "\n[sublime-text]\nServer = https://download.sublimetext.com/arch/stable/x86_64" | sudo tee -a /etc/pacman.conf
	sudo pacman -Syu sublime-text

	#Takes a long time to compile so they are at the end
 	pamac build mimi-git ytop progress-git vtop spicetify-cli cava expressvpn spotify espanso oomox pmenu

 	
 	# Misc

 	#Disable dunst autostart via systemd so that it's started by i3 with Xresources colors
 	systemctl --user disable dunst
	systemctl --user stop dunst


	echo "Install dotfiles? "
	read answer
	if [ "$answer" == "y" ]; then
		$HOME/dotfiles/config -r -f -b
	else
		:
	fi
fi